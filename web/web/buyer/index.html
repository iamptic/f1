<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Foody · Витрина</title>
  <link rel="stylesheet" href="./style.css" />
  <script defer src="/config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <script defer src="./app.js"></script>
</head>
<body>
  <div class="tg-shell">
    <header class="tg-appbar">
      <div class="tg-appbar__left">
        <div class="avatar">F</div>
        <div class="meta">
          <div class="title">Foody · Витрина</div>
          <div class="subtitle">Скидки перед закрытием</div>
        </div>
      </div>
    </header>

    <main class="tg-content">
      <div class="toolbar">
        <input id="q" class="search" placeholder="Поиск" />
        <button id="refresh" class="btn">Обновить</button>
      </div>
      <div id="grid" class="grid"></div>
      <div id="gridSkeleton" class="grid skeleton hidden"></div>
    </main>
  </div>

  <!-- Bottom Sheet (offer details + reserve form) -->
  <div id="sheet" class="sheet hidden" aria-hidden="true">
    <div class="sheet__dialog">
      <div class="sheet__h">
        <div class="sheet__t" id="sTitle">—</div>
        <button class="sheet__x" id="sheetClose" aria-label="Закрыть">×</button>
      </div>
      <div class="sheet__b">
        <img id="sImg" alt="" />
        <div class="meta">
          <div id="sPrice" class="price">—</div>
          <div id="sOld" class="old">—</div>
          <div id="sQty" class="qty">—</div>
          <div id="sExp" class="exp">—</div><div id="sLeft" class="left muted">—</div>
        </div>

        <div class="reserve-form">
          <div class="row">
            <label for="sName">Имя</label>
            <input id="sName" placeholder="Как к вам обращаться">
          </div>
          <div class="row">
            <label for="sPhone">Телефон</label>
            <input id="sPhone" placeholder="+7...">
          </div>
          <div class="row">
            <label for="sAddress">Адрес (автозаполнение по гео)</label>
            <div class="address-line">
              <input id="sAddress" placeholder="Ваш адрес (можно отредактировать)" />
              <button id="geoBtn" class="btn small" type="button">Определить гео</button>
            </div>
            <div class="hint muted">Мы возьмём адрес из вашей геолокации — вы сможете поправить вручную.</div>
            <input type="hidden" id="sLat">
            <input type="hidden" id="sLng">
          </div>
        </div>

        <div class="actions"><button id="reserveBtn" class="btn primary">Забронировать</button></div>
      </div>
    </div>
  </div>

  <!-- QR / Redeem modal -->
  <div id="qrModal" class="sheet hidden" aria-hidden="true">
    <div class="sheet__dialog">
      <div class="sheet__h">
        <div class="sheet__t">Бронь оформлена</div>
        <button class="sheet__x" id="qrClose" aria-label="Закрыть">×</button>
      </div>
      <div class="sheet__b">
        <div class="qr-wrap">
          <canvas id="qrCanvas" width="220" height="220" aria-label="QR-код брони"></canvas>
        </div>
        <div class="qr-info">
          <div class="qr-code-line">Код для погашения: <strong id="qrCodeText">—</strong></div>
          <div id="qrHint" class="muted">Покажите этот код или QR сотруднику ресторана для погашения брони.</div>
        </div>
        <div class="actions">
          <button id="qrOk" class="btn primary">Готово</button>
        </div>
      </div>
    </div>
  </div>

  <div id="toast"></div>
</body>
</html>
