<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Foody · ЛК — QR / Брони</title>
  <link rel="stylesheet" href="./style.css" />
  <script defer src="/config.js"></script>
  <script defer src="./app.js"></script>
  <style>
    /* Минимальные стили для QR‑вкладки, чтобы работало из коробки */
    .tabs{display:flex;gap:8px;margin:12px 0}
    .tab-btn{border:1px solid var(--brd);border-radius:10px;padding:8px 12px;background:#121821;color:var(--text);cursor:pointer}
    .tab-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#0c0f15;border:0;font-weight:800}
    .tab{display:none}
    .tab.active{display:block}
    .qr-wrap{display:grid;gap:12px;grid-template-columns:1.2fr .8fr}
    .panel{background:var(--card);border:1px solid var(--brd);border-radius:16px;overflow:hidden}
    .panel-h{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--brd)}
    .panel-b{padding:12px}
    .row{display:flex;gap:8px;align-items:center}
    .input{flex:1;background:#0f141c;color:var(--text);border:1px solid var(--brd);border-radius:12px;padding:10px 12px}
    .btn{border:1px solid var(--brd);border-radius:12px;background:#121821;color:var(--text);padding:10px 12px;cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));border:0;color:#0b0f15;font-weight:800}
    video{width:100%;max-height:320px;border-radius:12px;border:1px solid var(--brd);background:#0d1218}
    .muted{color:var(--sub)}
    .toast-box{position:fixed;right:12px;bottom:16px;display:grid;gap:8px;z-index:60}
    .toast{background:#0f141c;border:1px solid var(--brd);border-left:6px solid var(--accent2);padding:10px 12px;border-radius:12px}
    .table-wrap{overflow:auto;max-height:480px}
    table{width:100%;border-collapse:separate;border-spacing:0}
    th,td{padding:10px 12px;border-bottom:1px solid var(--brd);white-space:nowrap}
    th{position:sticky;top:0;background:var(--card)}
  </style>
</head>
<body>
  <div class="tg-shell">
    <header class="tg-appbar">
      <div class="tg-appbar__left">
        <div class="avatar">F</div>
        <div class="meta">
          <div class="title">Foody · ЛК</div>
          <div class="subtitle">QR / Брони</div>
        </div>
      </div>
    </header>

    <main class="tg-content">
      <div class="tabs">
        <button class="tab-btn" data-tab="dashboard">Дашборд</button>
        <button class="tab-btn" data-tab="offers">Офферы</button>
        <button class="tab-btn active" data-tab="qr">QR / Брони</button>
      </div>

      <!-- QR / Брони -->
      <section id="qr" class="tab active">
        <div class="qr-wrap">
          <div class="panel">
            <div class="panel-h">
              <div>Погашение по коду</div>
            </div>
            <div class="panel-b">
              <div class="row">
                <input id="qr_code" class="input" placeholder="Вставьте код брони или отсканируйте" autocomplete="one-time-code" inputmode="text" />
                <button id="qr_redeem_btn" class="btn primary">Погасить</button>
                <button id="qr_scan_btn" class="btn">Сканировать</button>
                <button id="qr_stop_btn" class="btn">Стоп</button>
              </div>
              <div class="row muted">Совет: откройте камеру и наведите на QR/штрихкод; код можно также вставить из буфера обмена.</div>
              <video id="qr_video" playsinline muted></video>
            </div>
          </div>

          <div class="panel">
            <div class="panel-h">
              <div>Активные брони</div>
              <div class="muted" id="qr_total">—</div>
            </div>
            <div class="panel-b">
              <div class="row">
                <input id="qr_q" class="input" placeholder="Поиск по коду или телефону" />
                <select id="qr_status" class="input" style="flex:0 0 200px">
                  <option value="">Все</option>
                  <option value="active">Активные</option>
                  <option value="redeemed">Погашенные</option>
                  <option value="expired">Истёкшие</option>
                  <option value="canceled">Отменённые</option>
                </select>
                <button id="qr_refresh" class="btn">Обновить</button>
              </div>
              <div class="table-wrap">
                <table>
                  <thead>
                    <tr>
                      <th>Дата</th>
                      <th>Код</th>
                      <th>Оффер</th>
                      <th>Статус</th>
                      <th>До</th>
                      <th>Телефон</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="qr_tbody"></tbody>
                </table>
              </div>
              <div class="row" style="justify-content:flex-end;margin-top:8px">
                <button id="qr_more" class="btn">Загрузить ещё</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="toast" class="toast-box"></div>
</body>
</html>
